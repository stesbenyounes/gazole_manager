{% extends "base.html" %}

{% block title %}Dashboard - Gazole Manager{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ðŸ“ˆ Dashboard</h1>
    <p>Vue d'ensemble de votre flotte et consommation</p>
</div>

<!-- Cartes principales -->
<div class="summary-cards">
    <div class="card blue">
        <h3>VÃ©hicules</h3>
        <div class="value">{{ total_vehicles }}</div>
    </div>
    <div class="card pink">
        <h3>Chauffeurs</h3>
        <div class="value">{{ total_drivers }}</div>
    </div>
    <div class="card orange">
        <h3>EntrÃ©es</h3>
        <div class="value">{{ total_entries }}</div>
    </div>
    <div class="card green">
        <h3>CoÃ»t Total</h3>
        <div class="value">{{ totals.cost }}<span class="unit">TND</span></div>
    </div>
</div>

<!-- Cartes secondaires -->
<div class="summary-cards">
    <div class="card blue">
        <h3>Total Litres</h3>
        <div class="value">{{ totals.liters }}<span class="unit">L</span></div>
    </div>
    <div class="card green">
        <h3>Consommation Moyenne</h3>
        <div class="value">{{ avg_l_per_100 }}<span class="unit">L/100km</span></div>
    </div>
</div>

<!-- DerniÃ¨res EntrÃ©es -->
<div class="table-section">
    <div class="table-title">ðŸ“‹ DerniÃ¨res EntrÃ©es</div>
    {% if last_entries %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Chauffeur</th>
                <th>VÃ©hicule</th>
                <th>Litres</th>
                <th>CoÃ»t</th>
                <th>Station</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in last_entries %}
            <tr>
                <td>{{ entry.date.strftime('%d/%m/%Y') if entry.date else 'â€”' }}</td>
                <td>{{ entry.driver.name if entry.driver else 'â€”' }}</td>
                <td>{{ entry.vehicle.name if entry.vehicle else 'â€”' }}</td>
                <td class="value-positive">{{ entry.liters|round(2) if entry.liters else 'â€”' }}</td>
                <td>{{ entry.total_cost|round(3) if entry.total_cost else 'â€”' }}</td>
                <td>{{ entry.station or 'â€”' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="no-data">
        <p>Aucune entrÃ©e enregistrÃ©e</p>
    </div>
    {% endif %}
</div>

<!-- AccÃ¨s rapide -->
<div class="table-section" style="margin-top: 30px;">
    <div class="table-title">ðŸŽ¯ AccÃ¨s Rapide</div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px;">
        <a href="{{ url_for('driver_reports') }}" class="btn btn-primary" style="text-decoration: none; justify-content: center;">ðŸ“Š Rapports Chauffeur</a>
        <a href="{{ url_for('vehicle_reports') }}" class="btn btn-primary" style="text-decoration: none; justify-content: center;">ðŸš— Rapports VÃ©hicule</a>
        <a href="{{ url_for('import_csv') }}" class="btn btn-primary" style="text-decoration: none; justify-content: center;">ðŸ“¥ Importer CSV</a>
        <a href="{{ url_for('export_csv') }}" class="btn btn-primary" style="text-decoration: none; justify-content: center;">ðŸ“¤ Exporter CSV</a>
    </div>
</div>

{% endblock %}
